From 989891e20bec578405212ef6ca94e830af68eb6b Mon Sep 17 00:00:00 2001
From: "S.J.R. van Schaik" <stephan@whiteboxsystems.nl>
Date: Thu, 23 Feb 2017 11:49:43 +0000
Subject: [PATCH 10/14] sunxi: dts: enable SPI0 controller for Orange Pi Zero

---
 arch/arm/dts/sun8i-h2-plus-orangepi-zero.dts | 14 ++++++++++++++
 arch/arm/dts/sun8i-h3.dtsi                   |  8 ++++++++
 2 files changed, 22 insertions(+)

diff --git a/arch/arm/dts/sun8i-h2-plus-orangepi-zero.dts b/arch/arm/dts/sun8i-h2-plus-orangepi-zero.dts
index 20d489c..6a3aecd 100644
--- a/arch/arm/dts/sun8i-h2-plus-orangepi-zero.dts
+++ b/arch/arm/dts/sun8i-h2-plus-orangepi-zero.dts
@@ -59,6 +59,7 @@
 		serial0 = &uart0;
 		/* ethernet0 is the H3 emac, defined in sun8i-h3.dtsi */
 		ethernet1 = &xr819;
+		spi0 = &spi0;
 	};
 
 	chosen {
@@ -95,6 +96,19 @@
 	};
 };
 
+&pio {
+	spi0_pins: pinctrl {
+		pins = "PC0", "PC1", "PC2", "PC3";
+		drive-strength = <10>;
+		bias-disable;
+	};
+};
+
+&spi0 {
+	pinctrl-0 = <&spi0_pins>;
+	status = "okay";
+};
+
 &ehci1 {
 	status = "okay";
 };
diff --git a/arch/arm/dts/sun8i-h3.dtsi b/arch/arm/dts/sun8i-h3.dtsi
index afa6079..22f5fe6 100644
--- a/arch/arm/dts/sun8i-h3.dtsi
+++ b/arch/arm/dts/sun8i-h3.dtsi
@@ -158,6 +158,14 @@
 			#dma-cells = <1>;
 		};
 
+		spi0: spi@01c68000 {
+			compatible = "allwinner,sun8i-h3-spi";
+			reg = <0x01c68000 0x1000>;
+			status = "disabled";
+			#address-cells = <1>;
+			#size-cells = <0>;
+		};
+
 		mmc0: mmc@01c0f000 {
 			compatible = "allwinner,sun7i-a20-mmc",
 				     "allwinner,sun5i-a13-mmc";
-- 
2.7.4

